<html lang="en" data-textdirection="rtl" class="loading">

<!-- Mirrored from pixinvent.com/free-bootstrap-template/robust-lite/html/rtl/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 28 Jun 2017 06:37:27 GMT -->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="Robust admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords" content="admin template, robust admin template, dashboard template, flat admin template, responsive admin template, web app">
    <meta name="author" content="PIXINVENT">
    <title>وب سایت من</title>
    <link rel="apple-touch-icon" sizes="60x60" href="<?php echo plugins_url('emp/assets-profile/images/ico/apple-icon-60.png'); ?>">
    <link rel="apple-touch-icon" sizes="76x76" href="<?php echo plugins_url('emp/assets-profile/images/ico/apple-icon-76.png'); ?>">
    <link rel="apple-touch-icon" sizes="120x120" href="<?php echo plugins_url('emp/assets-profile/images/ico/apple-icon-120.png'); ?>">
    <link rel="apple-touch-icon" sizes="152x152" href="<?php echo plugins_url('emp/assets-profile/images/ico/apple-icon-152.png'); ?>">

    <link rel="shortcut icon" type="image/x-icon" href="https://pixinvent.com/free-bootstrap-template/robust-lite/app-assets/images/ico/favicon.ico">
    <link rel="shortcut icon" type="image/png" href="<?php echo plugins_url('emp/assets-profile/images/ico/favicon-32.png'); ?>">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <!-- BEGIN VENDOR CSS-->
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/bootstrap.css'); ?>">
    <!-- font icons-->

    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/fonts/icomoon.css'); ?>">
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/fonts/flag-icon-css/css/flag-icon.min.css'); ?>">
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/vendors/css/extensions/pace.css'); ?>">
    <!-- END VENDOR CSS-->
    <!-- BEGIN ROBUST CSS-->
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/bootstrap-extended.css'); ?>">
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/app.css'); ?>">
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/colors.css'); ?>">
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/custom-rtl.css'); ?>">
    <!-- END ROBUST CSS-->
    <!-- BEGIN Page Level CSS-->

    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/core/menu/menu-types/vertical-menu.css'); ?>">
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/core/menu/menu-types/vertical-overlay-menu.css'); ?>">
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/pages/login-register.css'); ?>">

    <!-- END Page Level CSS-->
    <!-- BEGIN Custom CSS-->
    <!--    <link rel="stylesheet" type="text/css" href="--><?php //echo plugins_url('emp/assets-profile/css/style-rtl.css'); ?><!--">-->
    <!-- END Custom CSS-->

    <!-- BEGIN Custom font-->
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets/css/login-style.css'); ?>">
    <!-- END Custom Font-->



    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/mdb/mdb.min.css'); ?>">
<!--        <link rel="stylesheet" type="text/css" href="--><?php //echo plugins_url('emp/assets-profile/css-rtl/mdb/jquery.dataTables.min.css'); ?><!--">-->
<!--        <link rel="stylesheet" type="text/css" href="--><?php //echo plugins_url('emp/assets-profile/css-rtl/mdb/buttons.dataTables.min.css'); ?><!--">-->
<!--    <link rel="stylesheet" type="text/css" href="--><?php //echo plugins_url('emp/assets-profile/css-rtl/persian-date/persian-datepicker.min.css'); ?><!--">-->

    <!-- BEGIN image upload-->
    <link rel="stylesheet" type="text/css" href="<?php echo plugins_url('emp/assets-profile/css-rtl/file-upload/fancy_fileupload.css'); ?>">
    <!-- END image upload-->

    <style type="text/css">
        [data-notify="progressbar"] {
            margin-bottom: 0px;
            position: absolute;
            bottom: 0px;
            left: 0px;
            width: 100%;
            height: 5px;
        }
        [data-notify="dismiss"] {
            float: left;
        }
        .ff_fileupload_wrap .ff_fileupload_dropzone{
            height: 100px;
        }

        @media screen and (min-width: 640px) {
            .dataTables_wrapper .dataTables_length, .dataTables_wrapper .dataTables_filter {
                text-align: left;
            }
        }
        .dataTables_wrapper .dataTables_length, .dataTables_wrapper .dataTables_filter {
            margin: 10px;
        }
        .custom-select{
            font-family: IRANSansWeb;
        }

        .popover{
            left: 0;
            right: auto;
            font-family: IRANSansWeb;
        }

        /*.popover-content {*/
            /*display: none;*/
        /*}*/
        .btn-floating{
            margin: 0px;
        }
        .datepicker-plot-area{
            font-family: IRANSansWeb;
        }
        .trigger {
            padding: 1px 10px;
            font-size: 12px;
            font-weight: 400;
            border-radius: 10px;
            background-color: #eee;
            color: #212121;
            display: inline-block;
            margin: 2px 5px;
        }

        .hoverable, .trigger {
            transition: box-shadow 0.55s;
            /*box-shadow: 0px;*/
        }

        .hoverable:hover, .trigger:hover {
            transition: box-shadow 0.45s;
            box-shadow: 0 8px 17px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        }

        td{
            direction: ltr;
            text-align: center;
            font-family: IRANSansWeb !important;
        }

        div.dt-buttons{
            float: right;
        }
        button.dt-button, div.dt-button, a.dt-button{
            border-radius: 40px;
        }

        .dataTables_info{
            float: left;
            padding: 20px;
        }
        .table th, .table td{
            vertical-align: middle;
        }
        #pdr_date_insert2 , #pdr_max_temp_insert,#pdr_min_temp_insert{
            text-align: center;
        }
    </style>

</head>
<body data-open="click" data-menu="vertical-menu" data-col="2-columns" class="vertical-layout vertical-menu 2-columns  fixed-navbar">
<!-- navbar-fixed-top-->
<?php
require_once( ABSPATH . 'wp-admin/includes/upgrade.php' );
global $wpdb;
    $e_id=get_current_user_id();
    $table = $wpdb->prefix .'projects';
    $query = "SELECT * FROM {$table} WHERE eid={$e_id}";
    $result=$wpdb->get_row($query);
    $expected_cost=$result->expected_cost;
    $p_id=$result->id;

    $table = $wpdb->prefix .'projects_notification';
    $query = "SELECT COUNT(*) FROM {$table} WHERE p_id={$p_id} AND status = 'pending' ";
    $p_not_count=$wpdb->get_var($query);

    $table = $wpdb->prefix .'projects_messages';
    $query = "SELECT COUNT(*) FROM {$table} WHERE p_id={$p_id} AND status = 'pending' and receiver='employee'";
    $p_message_count=$wpdb->get_var($query);
?>
<?php require_once( plugin_dir_path(__FILE__) . 'header/header.php' ); ?>

<!-- ////////////////////////////////////////////////////////////////////////////-->


<!-- main menu-->
<div data-scroll-to-active="true" class="main-menu menu-fixed menu-dark menu-accordion menu-shadow">
    <!-- main menu header-->
    <div class="main-menu-header">
        <!--            <input type="text" placeholder="Search" class="menu-search form-control round"/>-->
    </div>
    <!-- / main menu header-->
    <!-- main menu content-->
    <?php require_once( plugin_dir_path(__FILE__) . 'sidebar/sidebar-menu.php' ); ?>
    <!-- /main menu content-->
    <!-- main menu footer-->
    <!-- include includes/menu-footer-->
    <!-- main menu footer-->
</div>
<!-- / main menu-->

<div class="app-content content container-fluid">
    <div class="content-wrapper">

        <div class="content-body">
            <?php
            if (isset($_GET['p_id']))
            {
                require_once( ABSPATH . 'wp-admin/includes/upgrade.php' );
                global $wpdb;
                $p_id=intval($_GET['p_id']);
                $table = $wpdb->prefix .'projects';
                $e_id=get_current_user_id();
                $query = "SELECT * FROM {$table} WHERE id={$p_id} and eid={$e_id}";
                $results=$wpdb->get_results($query);
                if (count($results)==0)
                {
                    wp_redirect(home_url().'/se_panel');
                }

            }
            else
            {
                wp_redirect(home_url().'/se_panel');
            }
            ?>

            <div class="row">
                <div class="col-md-4">
                    <div class="card">
                        <div class="card-header"><h4 class="card-title" id="basic-layout-colored-form-control"><i class="icon-mail6"></i>
                                پیام جــدید</h4>
                            <a class="heading-elements-toggle"><i class="icon-ellipsis font-medium-3"></i></a>
                            <div class="heading-elements">
                                <ul class="list-inline mb-0">
                                    <li><a data-action="collapse"><i class="icon-minus4"></i></a></li>
                                    <li><a data-action="expand"><i class="icon-expand2"></i></a></li>
                                </ul>
                            </div>
                        </div>
                        <div class="card-body collapse in">
                            <div class="card-block">
                                <form class="form"  id="pnn_form" enctype="multipart/form-data">
                                    <div class="form-body">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label>گیــرنده</label>
                                                    <div class="input-group">
                                                        <label class="display-inline-block custom-control custom-radio ml-1">
                                                            <input type="radio" name="pnn_receiver" checked="" class="custom-control-input" value="admin">
                                                            <span class="custom-control-indicator"></span>
                                                            <span class="custom-control-description ml-0">مدیریت</span>
                                                        </label>
                                                        <label class="display-inline-block custom-control custom-radio">
                                                            <input type="radio" name="pnn_receiver" class="custom-control-input" value="supervisor">
                                                            <span class="custom-control-indicator"></span>
                                                            <span class="custom-control-description ml-0">سرپرست</span>
                                                        </label>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="pnn_title">عــنوان</label>
                                                    <div class="position-relative has-icon-left">
                                                        <input type="text" id="pnn_title" class="form-control round border-primary" placeholder="عـــنوان" name="pnn_title">
                                                        <div class="form-control-position">
                                                            <i class="icon-ios-compose fa-lg"></i>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>

                                            <div class="col-md-12">
                                                <div class="form-group">
                                                    <label for="pnn_text"> مـــتن پیام</label>
                                                    <div class="position-relative has-icon-left">
                                                        <textarea rows="5" id="pnn_text" class="form-control round border-primary" placeholder="متن مدنظرتان را وارد نمایید" name="pnn_text"></textarea>
                                                        <div class="form-control-position">
                                                            <i class="icon-document-text"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12" id="pnn_upload_div_1">
                                                <div class="form-group">
                                                    <button type="button" id="pnn_file_1" class="btn btn-primary btn-sm btn-rounded">
                                                        <i class="icon-paper-clip fa-lg"></i> افزودن ضمیمه
                                                    </button>
                                                </div>

                                            </div>

                                            <div class="col-md-12" id="pnn_upload_div_2" style="display: none">
                                                <div class="form-group">
                                                    <label for="pnn_file">ضمیمه</label>
                                                    <div class="position-relative has-icon-left">
                                                        <input type="file" id="pnn_file" class="form-control round border-primary" name="pnn_file">
                                                        <div class="form-control-position" id="pnn_upload_icon">
                                                            <i class="icon-paper-clip"></i>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>

                                        </div>
                                    </div>

                                    <div class="form-actions right">
                                        <button type="button" id="pnn_submit" data-class-id="pnn_submit" class="btn btn-block btn-success">
                                            <i class="icon-ei-sc-telegram fa-lg"></i> ارســـال
                                        </button>
                                    </div>
                                </form>

                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-8">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    <h4 class="card-title"><i class="icon-outbox font-medium-3"></i> صندوق ارسالی &nbsp;</h4>
                                    <a class="heading-elements-toggle"><i class="icon-ellipsis font-medium-3"></i></a>
                                    <div class="heading-elements">
                                        <ul class="list-inline mb-0">
                                            <li><a data-action="collapse"><i class="icon-minus4"></i></a></li>
                                            <li><a data-action="expand"><i class="icon-expand2"></i></a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="card-block">
                                        <p>
                                    <span class="float-xs-left red-text">
                                        <b>
                                            <i class="icon-check"></i> جهت مشاهده متن پیام ، روی <i style="    border: 1px dashed green; color: green;padding: 0 5px;"> عنــوان </i> &nbsp;پیام مدنظر کلیک فرمایید.
                                        </b>
                                    </span>
                                        </p>
                                    </div>
                                    <div class="table-responsive">
                                        <table id="project_message_sent_tbl" class="table table-responsive-sm table-sm table-hover table-bordered mb-0">

                                            <thead class="thead-inverse">
                                            <tr>
                                                <th class="text-xs-center align-middle"  width="10%">#</th>
                                                <th class="text-xs-center align-middle">گیرنده </th>
                                                <th class="text-xs-center align-middle">عنوان و متن </th>
                                                <th class="text-xs-center align-middle">زمان</th>
                                                <th class="text-xs-center align-middle">ضمیمه</th>
                                                <th class="text-xs-center align-middle">وضعیت</th>
                                                <th class="text-xs-center align-middle">عملیات</th>
                                            </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    <h4 class="card-title"><i class="icon-inbox2 font-medium-3"></i> صندوق دریافتی &nbsp;</h4>
                                    <a class="heading-elements-toggle"><i class="icon-ellipsis font-medium-3"></i></a>
                                    <div class="heading-elements">
                                        <ul class="list-inline mb-0">
                                            <li><a data-action="collapse"><i class="icon-minus4"></i></a></li>
                                            <li><a data-action="expand"><i class="icon-expand2"></i></a></li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div class="card-block">
                                        <p>
                                    <span class="float-xs-left red-text">
                                        <b>
                                            <i class="icon-check"></i> جهت مشاهده متن پیام ، روی <i style="    border: 1px dashed green; color: green;padding: 0 5px;"> عنــوان </i> &nbsp;پیام مدنظر کلیک فرمایید.
                                        </b>
                                    </span>
                                        </p>
                                    </div>
                                    <div class="table-responsive">
                                        <table id="project_message_recevie_tbl" class="table table-responsive-sm table-sm table-hover table-bordered mb-0">

                                            <thead class="thead-inverse">
                                            <tr>
                                                <th class="text-xs-center align-middle"  width="10%">#</th>
                                                <th class="text-xs-center align-middle">فرستنده </th>
                                                <th class="text-xs-center align-middle">عنوان و متن </th>
                                                <th class="text-xs-center align-middle">زمان</th>
                                                <th class="text-xs-center align-middle">ضمیمه</th>
                                                <th class="text-xs-center align-middle">وضعیت</th>
                                                <th class="text-xs-center align-middle">عملیات</th>
                                            </tr>
                                            </thead>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
<div>

    <!-- ////////////////////////////////////////////////////////////////////////////-->

    <?php //require_once( plugin_dir_path(__FILE__) . 'footer/footer.php' ); ?>


    <!-- BEGIN VENDOR JS-->
    <script src="<?php echo plugins_url('emp/assets-profile/js/core/libraries/jquery.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/ui/tether.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/core/libraries/bootstrap.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/ui/perfect-scrollbar.jquery.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/ui/unison.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/ui/blockUI.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/ui/jquery.matchHeight-min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/ui/screenfull.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/extensions/pace.min.js'); ?>" type="text/javascript"></script>
    <!-- BEGIN PAGE VENDOR JS-->
    <script src="<?php echo plugins_url('emp/assets-profile/vendors/js/charts/chart.min.js'); ?>" type="text/javascript"></script>
    <!-- END PAGE VENDOR JS-->
    <!-- BEGIN ROBUST JS-->
    <script src="<?php echo plugins_url('emp/assets-profile/js/core/app-menu.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/core/app.js'); ?>" type="text/javascript"></script>
    <!-- END ROBUST JS-->
    <!-- BEGIN PAGE LEVEL JS-->
    <!--<script src="--><?php //echo plugins_url('emp/assets-profile/js/scripts/pages/dashboard-lite.js'); ?><!--" type="text/javascript"></script>-->

    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/mdb.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/popper.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/datatables.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/dataTables.buttons.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/buttons.flash.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/jszip.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/pdfmake.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/vfs_fonts.js'); ?>" type="text/javascript"></script>

    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/buttons.html5.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/buttons.print.min.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/mdb/persian.js'); ?>" type="text/javascript"></script>


    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/digitSeprator/autonumbric.min.js'); ?>" type="text/javascript"></script>

    <script src="<?php echo plugins_url('emp/assets-profile/js/time-picker/mdtimepicker.js'); ?>" type="text/javascript"></script>

    <!-- start file upload-->
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/image-upload/jquery.ui.widget.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/image-upload/jquery.fileupload.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/image-upload/jquery.iframe-transport.js'); ?>" type="text/javascript"></script>
    <script src="<?php echo plugins_url('emp/assets-profile/js/scripts/image-upload/jquery.fancy-fileupload.js'); ?>" type="text/javascript"></script>

    <!-- end file upload-->

    <!-- start bootstrap notify master-->
    <script src="<?php echo plugins_url('emp/assets-profile/js/bootstrap-notify-master/bootstrap-notify.min.js'); ?>" type="text/javascript"></script>
    <!-- end  bootstrap notify master-->



    <script type="text/javascript">

        $(document).ready(function ()
        {

            fetch_project_message_sent_tbl();
            function fetch_project_message_sent_tbl()
            {
                var project_message_sent_tbl = $('#project_message_sent_tbl').DataTable
                (
                    {
                        "pagingType": "full_numbers",
                        // "paging": false,
                        "tabIndex": 1,
                        "order": [[ 0, "desc" ]],
                        "pageLength":5,
                        "searching": true,
                        "bAutoWidth": false,
                        "language": {
                            "processing": "در حال پردازش اطلاعات ...",
                            "sInfo":"نمایش _START_ تا _END_ از مجموع _TOTAL_ مورد",
                            "emptyTable": "رکوردی یافت نشد",
                            "lengthMenu": "",
                            "zeroRecords": "رکوردی یافت نشد",
                            "info": "",
                            "infoEmpty": "",
                            "infoFiltered": "",
                            "search": "_INPUT_",
                            "searchPlaceholder": "جستجو ...",
                            "paginate": {
                                "previous": "بعدی",
                                "next": "قبلی",
                                "last" : "»",
                                "first" : "«"
                            }

                        },
                        // "processing": true,
                        "serverSide": true,
                        "ajax": {
                            "url"  : "<?php echo admin_url('admin-ajax.php?action=project_emp_message_sent_data&p_id=' . $p_id)?>"
                        },
                        "fnDrawCallback" : function() {
                            traverse(document.body);

                            $('[data-toggle="popover-hover"]').popover({
                                // html: true,
                                trigger: 'hover',
                                placement: 'bottom'
                            });
                        }
                    }
                );


            }

            persian={0:'۰',1:'۱',2:'۲',3:'۳',4:'۴',5:'۵',6:'۶',7:'۷',8:'۸',9:'۹'};
            function traverse(el){
                if(el.nodeType==3){
                    var list=el.data.match(/[0-9]/g);
                    if(list!=null && list.length!=0){
                        for(var i=0;i<list.length;i++)
                            el.data=el.data.replace(list[i],persian[list[i]]);
                    }
                }
                for(var i=0;i<el.childNodes.length;i++){
                    traverse(el.childNodes[i]);
                }
            }

            fetch_project_message_receive_tbl();
            function fetch_project_message_receive_tbl()
            {
                var project_message_recevie_tbl = $('#project_message_recevie_tbl').DataTable
                (
                    {
                        "pagingType": "full_numbers",
                        // "paging": false,
                        "tabIndex": 1,
                        "order": [[ 0, "desc" ]],
                        "pageLength":5,
                        "searching": true,
                        "bAutoWidth": false,
                        "language": {
                            "processing": "در حال پردازش اطلاعات ...",
                            "sInfo":"نمایش _START_ تا _END_ از مجموع _TOTAL_ مورد",
                            "emptyTable": "رکوردی یافت نشد",
                            "lengthMenu": "",
                            "zeroRecords": "رکوردی یافت نشد",
                            "info": "",
                            "infoEmpty": "",
                            "infoFiltered": "",
                            "search": "_INPUT_",
                            "searchPlaceholder": "جستجو ...",
                            "paginate": {
                                "previous": "بعدی",
                                "next": "قبلی",
                                "last" : "»",
                                "first" : "«"
                            }

                        },
                        // "processing": true,
                        "serverSide": true,
                        "ajax": {
                            "url"  : "<?php echo admin_url('admin-ajax.php?action=project_emp_message_recevie_data&p_id=' . $p_id)?>"
                        },
                        "fnDrawCallback" : function() {
                            traverse(document.body);

                            $('[data-toggle="popover-hover"]').popover({
                                // html: true,
                                trigger: 'hover',
                                placement: 'bottom'
                            });
                        }
                    }
                );


            }

            var added;
            var pnn_title;
            var pnn_text;
            var pnn_receiver;

            $(document).on('click', '.ff_fileupload_actions button.ff_fileupload_remove_file', function(){
                $("#pnn_upload_div_2").hide();
                $("#pnn_upload_div_1 ").show();
            });

            $(document).on('click', '#pnn_submit', function()
            {
                pnn_text=$('#pnn_text').val();
                pnn_title=$('#pnn_title').val();
                pnn_receiver = $("input[name='pnn_receiver']:checked").val();

                if (pnn_text != '' && pnn_title!=''&& pnn_receiver!='')
                {
                    if (added)
                    {
                        $(".ff_fileupload_actions button.ff_fileupload_start_upload ").click();
                    }
                    else
                    {
                        $.ajax({
                            url:"<?php echo admin_url('admin-ajax.php')?>",
                            data:{
                                action:'emp_pnm_add2',
                                p_id:<?php echo $p_id;?>,
                                pnn_title:pnn_title,
                                pnn_text :pnn_text,
                                pnn_receiver : pnn_receiver
                            },
                            success:function(msg)
                            {
                                $("#pnn_upload_div_2").hide();
                                $("#pnn_upload_div_1 ").show();
                                $("#pnn_title ").val("");
                                $("#pnn_text ").val("");
                                $('#project_message_sent_tbl').DataTable().destroy();
                                fetch_project_message_sent_tbl();
                                $.notify(
                                    {
                                        message: msg
                                    },
                                    {
                                        type: 'success',
                                        placement: {
                                            from: "top",
                                            align: "left"
                                        },
                                        showProgressbar : true,
                                        mouse_over: "pause",
                                        allow_dismiss : false
                                    }
                                );
                            }
                        });
                    }
                }
                else
                {
                    $.notify(
                        {
                            message: 'لطفا تمامی فیلد ها را وارد نمایید!'
                        },
                        {
                            type: 'danger',
                            placement: {
                                from: "top",
                                align: "left"
                            },
                            showProgressbar : true,
                            mouse_over: "pause",
                            allow_dismiss : false
                        }
                    );
                }

            });


            $(document).on('click', '#pnn_file_1', function()
            {
                pnn_text=$('#pnn_text').val();
                pnn_title=$('#pnn_title').val();
                pnn_receiver = $("input[name='pnn_receiver']:checked").val();

                if (pnn_text != '' && pnn_title!='' && pnn_receiver!='')
                {
                    $("#pnn_upload_div_1 ").hide();
                    $("#pnn_upload_div_2 ").show();
                    $('#pnn_file').FancyFileUpload({
                        url : "<?php echo admin_url('admin-ajax.php')?>",
                        params :
                            {
                            action : 'pnm_add',
                            p_id : <?php echo $p_id;?>,
                            pnn_title:pnn_title,
                            pnn_text :pnn_text,
                            pnn_receiver :pnn_receiver

                        },
                        maxfilesize : 1000000,
                        added : function(e, data)
                        {
                            // It is okay to simulate clicking the start upload button.
                            this.find('.ff_fileupload_actions button.ff_fileupload_start_upload').hide();
                            $(".ff_fileupload_dropzone ").hide();
                            $("#pnn_upload_icon ").hide();
                            added=true;
                        },
                        uploadcompleted : function(e, data)
                        {
                            $("#pnn_upload_div_2").hide();
                            $("#pnn_upload_div_1 ").show();
                            $("#pnn_title ").val("");
                            $("#pnn_text ").val("");
                            $('#project_message_sent_tbl').DataTable().destroy();
                            fetch_project_message_sent_tbl();

                            $.notify(
                                {
                                    message: 'پیام مدنظر با موفقیت ارسال گــردید!'
                                },
                                {
                                    type: 'success',
                                    placement: {
                                        from: "top",
                                        align: "left"
                                    },
                                    showProgressbar: true,
                                    mouse_over: "pause",
                                    allow_dismiss: false
                                }
                            );
                        }
                    });
                }
                else
                {
                    $.notify(
                        {
                            message: 'ابتدا عنوان و متن پیام را وارد نمایید!'
                        },
                        {
                            type: 'danger',
                            placement: {
                                from: "top",
                                align: "left"
                            },
                            showProgressbar : true,
                            mouse_over: "pause",
                            allow_dismiss : false
                        }
                    );
                }

            });

            $(document).on('click', '#se_pn_delete', function(){
                var id = $(this).data("id");
                if(confirm("مطمئن هستید?"))
                {
                    $.ajax({
                        url:"<?php echo admin_url('admin-ajax.php?action=emp_pmd')?>",
                        data:{
                            id:id,
                        },
                        success:function(data){
                            $.notify(
                                {
                                    message: data
                                },
                                {
                                    type: 'success',
                                    placement: {
                                        from: "top",
                                        align: "left"
                                    },
                                    showProgressbar : true,
                                    mouse_over: "pause",
                                    allow_dismiss : false
                                }
                            );
                            $('#project_message_sent_tbl').DataTable().destroy();
                            fetch_project_message_sent_tbl();
                        }
                    });
                }
            });
            $(document).on('click', '#se_pmr_delete', function(){
                var id = $(this).data("id");
                if(confirm("مطمئن هستید?"))
                {
                    $.ajax({
                        url:"<?php echo admin_url('admin-ajax.php?action=emp_pmrd')?>",
                        data:{
                            id:id,
                        },
                        success:function(data){
                            $.notify(
                                {
                                    message: data
                                },
                                {
                                    type: 'success',
                                    placement: {
                                        from: "top",
                                        align: "left"
                                    },
                                    showProgressbar : true,
                                    mouse_over: "pause",
                                    allow_dismiss : false
                                }
                            );
                            $('#project_message_recevie_tbl').DataTable().destroy();
                            fetch_project_message_receive_tbl();
                        }
                    });
                }
            });


            $(document).on('click', '#se_project_send_message_title', function(){
                var id = $(this).data("id");
                var status = $(this).data("status");
                if (status == "pending")
                {
                    setTimeout(
                        function()
                        {
                            $.ajax({
                                url: "<?php echo admin_url('admin-ajax.php?action=project_emp_admin_send_message_update_status')?>",
                                data: {
                                    id: id,
                                },
                                success: function (data)
                                {
                                    $('#project_message_sent_tbl').DataTable().destroy();
                                    fetch_project_message_sent_tbl();
                                }
                            });

                        }, 3000);
                }
            });
            $(document).on('mouseenter', '#se_project_send_message_title', function(){
                var id = $(this).data("id");
                var status = $(this).data("status");
                if (status == "pending")
                {
                    setTimeout(
                        function()
                        {
                            $.ajax({
                                url: "<?php echo admin_url('admin-ajax.php?action=project_emp_admin_send_message_update_status')?>",
                                data: {
                                    id: id,
                                },
                                success: function (data)
                                {
                                    $('#project_message_sent_tbl').DataTable().destroy();
                                    fetch_project_message_sent_tbl();
                                }
                            });

                        }, 3000);
                }
            });



            $(document).on('click', '#se_project_receive_message_title', function(){
                var id = $(this).data("id");
                var status = $(this).data("status");
                if (status == "pending")
                {
                    setTimeout(
                        function()
                        {
                            $.ajax({
                                url: "<?php echo admin_url('admin-ajax.php?action=project_emp_admin_send_message_update_status')?>",
                                data: {
                                    id: id,
                                },
                                success: function (data)
                                {
                                    $('#project_message_recevie_tbl').DataTable().destroy();
                                    fetch_project_message_receive_tbl();
                                }
                            });

                        }, 3000);
                }
            });
            $(document).on('mouseenter', '#se_project_receive_message_title', function(){
                var id = $(this).data("id");
                var status = $(this).data("status");
                if (status == "pending")
                {
                    setTimeout(
                        function()
                        {
                            $.ajax({
                                url: "<?php echo admin_url('admin-ajax.php?action=project_emp_admin_send_message_update_status')?>",
                                data: {
                                    id: id,
                                },
                                success: function (data)
                                {
                                    $('#project_message_recevie_tbl').DataTable().destroy();
                                    fetch_project_message_receive_tbl();
                                }
                            });

                        }, 3000);
                }
            });

        });



    </script>
    <!-- END PAGE LEVEL JS-->

</body>

</html>

